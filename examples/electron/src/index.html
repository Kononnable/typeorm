<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Electron App</title>
</head>

<body>

    <h1>Posts:</h1>

    <ul id="postList"></ul>

    <small>Refresh and you'll see a new post added.</small>
    <script>
        var typeorm = require("typeorm-core");
        var {SqliteDriver} = require("typeorm-core/build/compiled/src/driver/sqlite/SqliteDriver");
        typeorm.createConnection({
            "typeORMOptions": {
                "logging": true,
                "synchronize": true,
                "logger": "simple-console",
                "entities": [
                    "src/entity/*.js"
                ],
            },
            "connectionOptions": {
                "type": "sqlite",
                "database": "database.sqlite"
            }
        },(connection,options)=>new SqliteDriver(
        connection,
        options
    )).then(() => {
            var post = {
                title: "post title",
                text: "post text"

            };
            return typeorm.getRepository("Post").save(post);

        }).then(() => {
            console.log("Saved successfully!");
            return typeorm.getRepository("Post").find();

        }).then(posts => {
            console.log("Posts: ", posts);

            let ul = document.getElementById("postList");
            posts.forEach(post => {
                var li = document.createElement('li');
                li.innerText = post.id + ". " + post.title;
                ul.appendChild(li);
            });
            console.log("renderer success")
        }).catch(error => {
            console.error("Error: ", error);
        });
    </script>

</body>

</html>
